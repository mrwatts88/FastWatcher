// Fast Watcher - Search Interface

// Color palette
global Colors {
    out property <color> bg: #e0e1dd;
    out property <color> text: #1d1a05;
    out property <color> accent-1: #778da9;
    out property <color> accent-2: #17255a;
    out property <color> danger: #b9314f;
    out property <color> white: #ffffff;
    out property <color> border: #c0c1bd;
}

export component AppWindow inherits Window {
    // Properties
    in-out property <string> search-text;
    in property <bool> is-searching: search-text.character-count >= 3;
    in-out property <int> sightings-count: 0;
    in-out property <int> taxa-count: 0;
    in-out property <int> trips-count: 0;

    // Callbacks
    callback search-changed(string);

    title: "Fast Watcher";
    background: Colors.bg;
    preferred-width: 800px;
    preferred-height: 600px;

    VerticalLayout {
        padding: 20px;
        spacing: 16px;

        // Search input container
        Rectangle {
            height: 50px;
            background: Colors.white;
            border-radius: 8px;
            border-width: 2px;
            border-color: Colors.border;

            HorizontalLayout {
                padding-left: 16px;
                padding-right: 16px;

                TextInput {
                    text <=> root.search-text;
                    font-size: 16px;
                    color: Colors.text;
                    vertical-alignment: center;

                    edited() => {
                        root.search-changed(self.text);
                    }
                }
            }
        }

        // Results area (only show if searching)
        if root.is-searching: Flickable {
            VerticalLayout {
                spacing: 24px;

                // Sightings section
                VerticalLayout {
                    spacing: 8px;

                    // Section header
                    HorizontalLayout {
                        height: 20px;
                        Text {
                            text: "Sightings (" + root.sightings-count + ")";
                            font-size: 14px;
                            font-weight: 600;
                            color: Colors.text;
                        }
                    }

                    // Divider line
                    Rectangle {
                        height: 1px;
                        background: Colors.accent-1;
                    }

                    // Placeholder for results
                    Rectangle {
                        height: 40px;
                        background: Colors.white;
                        border-radius: 4px;

                        Text {
                            text: "Results will appear here...";
                            font-size: 12px;
                            color: Colors.accent-1;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                }

                // Taxa section
                if root.taxa-count >= 0: VerticalLayout {
                    spacing: 8px;

                    HorizontalLayout {
                        height: 20px;
                        Text {
                            text: "Taxa (" + root.taxa-count + ")";
                            font-size: 14px;
                            font-weight: 600;
                            color: Colors.text;
                        }
                    }

                    Rectangle {
                        height: 1px;
                        background: Colors.accent-1;
                    }

                    Rectangle {
                        height: 40px;
                        background: Colors.white;
                        border-radius: 4px;

                        Text {
                            text: "Results will appear here...";
                            font-size: 12px;
                            color: Colors.accent-1;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                }

                // Trips section
                if root.trips-count >= 0: VerticalLayout {
                    spacing: 8px;

                    HorizontalLayout {
                        height: 20px;
                        Text {
                            text: "Trips (" + root.trips-count + ")";
                            font-size: 14px;
                            font-weight: 600;
                            color: Colors.text;
                        }
                    }

                    Rectangle {
                        height: 1px;
                        background: Colors.accent-1;
                    }

                    Rectangle {
                        height: 40px;
                        background: Colors.white;
                        border-radius: 4px;

                        Text {
                            text: "Results will appear here...";
                            font-size: 12px;
                            color: Colors.accent-1;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                }

                // Empty state when no results
                if root.is-searching && root.sightings-count == 0 && root.taxa-count == 0 && root.trips-count == 0: VerticalLayout {
                    alignment: center;

                    Text {
                        text: "No results found";
                        font-size: 14px;
                        color: Colors.accent-1;
                        horizontal-alignment: center;
                    }
                }
            }
        }

        // Welcome message when not searching
        if !root.is-searching: VerticalLayout {
            alignment: center;

            Text {
                text: "Type at least 3 characters to search";
                font-size: 14px;
                color: Colors.accent-1;
                horizontal-alignment: center;
            }
        }
    }
}
